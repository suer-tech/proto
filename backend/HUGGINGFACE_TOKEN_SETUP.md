# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–∫–µ–Ω–∞ Hugging Face –¥–ª—è –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏

## üéØ –ó–∞—á–µ–º –Ω—É–∂–µ–Ω —Ç–æ–∫–µ–Ω?

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–π –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏ –∞—É–¥–∏–æ —Å –ø–æ–º–æ—â—å—é `pyannote.audio` —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ –∫ Hugging Face Hub. –ú–æ–¥–µ–ª—å `pyannote/speaker-diarization-3.1` —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–π –∏ —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –Ω–∞ Hugging Face

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://huggingface.co
2. –ù–∞–∂–º–∏—Ç–µ "Sign Up" –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏–ª–∏ –≤–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ GitHub/Google
4. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ email –∞–¥—Ä–µ—Å

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–æ–¥–µ–ª–∏

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –º–æ–¥–µ–ª–∏: https://hf.co/pyannote/speaker-diarization-3.1
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Request access" (–ó–∞–ø—Ä–æ—Å–∏—Ç—å –¥–æ—Å—Ç—É–ø)
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É, —É–∫–∞–∑–∞–≤:
   - **Use case**: "Speaker diarization for meeting transcription"
   - **Organization**: –í–∞—à–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å)
   - **Additional information**: "Using for audio meeting transcription and protocol generation"
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –æ–¥–æ–±—Ä–µ–Ω–∏—è (–æ–±—ã—á–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç)

### 3. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: https://hf.co/settings/tokens
2. –ù–∞–∂–º–∏—Ç–µ "New token"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - **Name**: "Protocol Maker Diarization" (–∏–ª–∏ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ –∏–º—è)
   - **Type**: "Read" (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–µ–π)
4. –ù–∞–∂–º–∏—Ç–µ "Generate a token"
5. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω** - –æ–Ω –±–æ–ª—å—à–µ –Ω–µ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω!

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–∫–µ–Ω–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**Windows (PowerShell):**
```powershell
$env:HUGGINGFACE_HUB_TOKEN="hf_your_token_here"
```

**Windows (Command Prompt):**
```cmd
set HUGGINGFACE_HUB_TOKEN=hf_your_token_here
```

**Linux/macOS:**
```bash
export HUGGINGFACE_HUB_TOKEN="hf_your_token_here"
```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –§–∞–π–ª .env (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ `backend/`
2. –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É:
```
HUGGINGFACE_HUB_TOKEN=hf_your_token_here
```

3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ .env:
```bash
pip install python-dotenv
```

4. –î–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—á–∞–ª–æ `main.py`:
```python
from dotenv import load_dotenv
load_dotenv()
```

#### –í–∞—Ä–∏–∞–Ω—Ç 3: –ü—Ä—è–º–æ –≤ –∫–æ–¥–µ (–ù–ï —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

–í —Ñ–∞–π–ª–µ `backend/main.py` –∏–ª–∏ `backend/services/audio_diarization.py`:
```python
import os
os.environ['HUGGINGFACE_HUB_TOKEN'] = 'hf_your_token_here'
```

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### 1. –¢–µ—Å—Ç —á–µ—Ä–µ–∑ Python

```python
import os
from services.audio_diarization import AudioDiarization

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ç–æ–∫–µ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
token = os.getenv('HUGGINGFACE_HUB_TOKEN')
print(f"Token set: {bool(token)}")

# –¢–µ—Å—Ç–∏—Ä—É–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
diarizer = AudioDiarization(use_auth_token=token)
print("Diarization service initialized successfully!")
```

### 2. –¢–µ—Å—Ç —á–µ—Ä–µ–∑ API

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
python main.py

# –¢–µ—Å—Ç –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏
curl -X POST "http://localhost:3001/api/diarize" \
  -F "audioFile=@test_audio.wav" \
  -F "minSpeakers=2" \
  -F "maxSpeakers=4"
```

### 3. –¢–µ—Å—Ç —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç

```bash
python simple_diarization_test.py "–£—Å–ø–µ—à–Ω—ã–µ_—Ö–æ–ª–æ–¥–Ω—ã–µ_–∑–≤–æ–Ω–∫–∏_–ø—Ä–∏–º–µ—Ä—ã_–î–æ_–ø—Ä–æ–¥–∞–∂–∏_–∫—É–ø–∏–≤—à–∏–º.m4a" --min-speakers 2 --max-speakers 4
```

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "Authentication required"

```
ValueError: Authentication required to access pyannote/speaker-diarization-3.1
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–æ–∫–µ–Ω –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ—Å—Ç—É–ø –∫ –º–æ–¥–µ–ª–∏ –æ–¥–æ–±—Ä–µ–Ω

### –û—à–∏–±–∫–∞ "Invalid token"

```
ValueError: Invalid token
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –Ω–µ –∏—Å—Ç–µ–∫
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω

### –û—à–∏–±–∫–∞ "Model not found"

```
OSError: Model pyannote/speaker-diarization-3.1 not found
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ—Å—Ç—É–ø –∫ –º–æ–¥–µ–ª–∏ –æ–¥–æ–±—Ä–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
import os
from services.audio_diarization import AudioDiarization

# –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
token = os.getenv('HUGGINGFACE_HUB_TOKEN')

# –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –¥–∏–∞—Ä–∏–∑–∞—Ç–æ—Ä–∞
diarizer = AudioDiarization(
    device="cpu",
    use_auth_token=token
)

# –í—ã–ø–æ–ª–Ω—è–µ–º –¥–∏–∞—Ä–∏–∑–∞—Ü–∏—é
result = await diarizer.diarize_audio(
    audio_file_path="meeting.wav",
    min_speakers=2,
    max_speakers=5
)
```

### –° —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–µ–π

```python
from services.audio_processor import AudioProcessor

processor = AudioProcessor(model_size="medium", device="cpu")
result = await processor.process_audio_with_diarization(
    audio_file_path="meeting.wav",
    participants=[{"name": "John"}, {"name": "Jane"}],
    prompt="Meeting transcription",
    enable_diarization=True,
    min_speakers=2,
    max_speakers=5
)
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ Git!**
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
3. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Ç–æ–∫–µ–Ω—ã
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–∫–µ–Ω—ã —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ (Read-only)

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **CPU**: ~2GB RAM, –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–ª–∏–Ω—ã –∞—É–¥–∏–æ
- **GPU**: ~4GB VRAM, –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ
- **–ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**: –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ (~500MB)

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ pyannote.audio

---

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Mock –¥–∏–∞—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Ç–æ–∫–µ–Ω–∞, –Ω–æ —Å –º–µ–Ω—å—à–µ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é. –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –¥–∏–∞—Ä–∏–∑–∞—Ü–∏—é —Å —Ç–æ–∫–µ–Ω–æ–º.
